{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Add case notes field to surgery cases (frontend)",
  "requirements": [
    {
      "id": "REQ-4",
      "summary": "Add a multi-line \"Case Notes\" textarea to the create/edit case form and bind it to form state so it can be saved and later edited.",
      "acceptanceCriteria": [
        "The New Case form includes a textarea labeled \"Case Notes\".",
        "The Case Details (edit) form includes the same textarea pre-filled with existing notes.",
        "Submitting the form saves notes; re-opening the case shows the saved notes."
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/cases/CaseForm.tsx",
          "operation": "modify",
          "description": "Add a new \"Case Notes\" multi-line textarea field to the form UI; include `notes` in the form defaultValues (using `initialData?.notes` for edits) and ensure the submitted `CaseFormData` includes the notes string."
        }
      ]
    },
    {
      "id": "REQ-5",
      "summary": "Update frontend types and data flow to carry the notes field through queries/mutations and import/export (JSON + CSV).",
      "acceptanceCriteria": [
        "Frontend `CaseFormData` includes a notes string field.",
        "`useCreateCase` and `useUpdateCase` send notes to the backend.",
        "JSON import/export continues to work with notes present in exported cases and accepted on import.",
        "CSV import continues to work; if a notes column is provided, it is imported; if omitted, notes defaults to an empty string."
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/cases/CaseForm.tsx",
          "operation": "modify",
          "description": "Extend `CaseFormData` to include `notes: string`, and ensure the internal react-hook-form schema tracks `notes` so create/update flows can pass it end-to-end."
        },
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Update `useCreateCase` and `useUpdateCase` mutations to pass `data.notes` into the backend calls in the correct argument position so notes persist on create and update."
        },
        {
          "path": "frontend/src/pages/CaseListPage.tsx",
          "operation": "modify",
          "description": "Adjust JSON import mapping to ensure imported cases always include `notes` (default to empty string when missing) so importing older exports remains compatible."
        },
        {
          "path": "frontend/src/utils/surgeryCaseCsvImport.ts",
          "operation": "modify",
          "description": "Add optional CSV support for a `notes` column (case-insensitive like other columns): parse it as plain text, default to an empty string when absent, and include it on the constructed `SurgeryCase` objects returned from `parseCsvToSurgeryCases`."
        }
      ]
    }
  ]
}